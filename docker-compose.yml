# requires variable config loading, such as:
# docker stack deploy -c <(docker-compose config) proxy
#
# also needs an .env file with some variables!

version: '3'
networks:
    proxy:
        external: true
services:
    web-proxy:
        image: nginx:1.17
        volumes:
        - /etc/ssl/certs/purplebirdman/:/etc/ssl/certs/
        - ./nginx.conf:/etc/nginx/nginx.conf
        - ./conf.d/:/etc/nginx/conf.d/
        environment:
        - NGINX_HOST=purplebirdman.com
        - NGINX_PORT=443
        ports:
        - 443:443
        networks:
        - proxy
